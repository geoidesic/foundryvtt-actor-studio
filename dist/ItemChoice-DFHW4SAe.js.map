{"version":3,"file":"ItemChoice-DFHW4SAe.js","sources":["../src/components/molecules/dnd5e/Advancements/ItemChoice.svelte"],"sourcesContent":["<script>\n  import { getContext, onDestroy, onMount, tick } from \"svelte\";\n  import { getAdvancementValue } from \"~/src/helpers/Utility\";\n  \n  export let advancement = null;\n\n  $: count = advancement?.configuration?.choices?.[0]\n    ? typeof advancement.configuration.choices[0] === 'object' && advancement.configuration.choices[0] !== null\n      ? advancement.configuration.choices[0].count\n      : advancement.configuration.choices[0]\n    : '-';\n\n  // Helper function to extract compendium name from UUID\n  function getCompendiumNameFromUuid(uuid) {\n    try {\n      // UUID format: Compendium.{packName}.{entityType}.{entityId}\n      const parts = uuid.split('.');\n      if (parts.length >= 2 && parts[0] === 'Compendium') {\n        return parts[1];\n      }\n      return null;\n    } catch (error) {\n      return null;\n    }\n  }\n\n  // Helper function to check if compendium is available\n  function isCompendiumAvailable(uuid) {\n    const compendiumName = getCompendiumNameFromUuid(uuid);\n    if (!compendiumName) return false;\n    \n    const pack = game.packs.get(`Compendium.${compendiumName}`);\n    return pack && pack.visible;\n  }\n\n  // Helper function to get user-friendly error message\n  function getErrorMessage(uuid) {\n    const compendiumName = getCompendiumNameFromUuid(uuid);\n    if (compendiumName) {\n      return `Compendium \"${compendiumName}\" is missing.`;\n    }\n    return `Error loading item: ${uuid}`;\n  }\n\n  onMount(async () => {\n  \n  });\n  \n</script>\n\n<template lang=\"pug\">\n  .advancement.mt-sm(data-type=\"{advancement.type}\")\n    +if(\"advancement.title === 'Cantrip'\")\n      .flexrow\n        .flex.left {getAdvancementValue(advancement, 'hint')}\n      +else()\n        .flexrow\n          h4.flex.left\n            span Choose&nbsp\n            span {count}&nbsp\n            span from: \n        ul.icon-list\n          +each(\"advancement.configuration.pool as pool\")\n            +await(\"fromUuid(pool.uuid)\")\n              +then(\"item\")\n                +if(\"item\")\n                  li.left\n                    .flexrow\n                      .flex0.relative.image\n                        img.icon(src=\"{item.img}\" alt=\"{item.name}\")\n                      .flex2 {item.name}\n                  +else()\n                    li.left.error-item\n                      .flexrow\n                        .flex0.relative.image\n                          i.fas.fa-exclamation-triangle.icon(style=\"color: #ff6b6b;\")\n                        .flex2 {getErrorMessage(pool.uuid)}\n              +catch(\"error\")\n                li.left.error-item\n                  .flexrow\n                    .flex0.relative.image\n                      i.fas.fa-exclamation-triangle.icon(style=\"color: #ff6b6b;\")\n                    .flex2 {getErrorMessage(pool.uuid)}\n\n</template>\n\n<style lang=\"sass\">\n  @import \"../../../../../styles/Mixins.sass\"\n  .advancement\n    @include inset\n    @include staticOptions\n    \n  .icon-list\n    padding: 0\n    margin: 4px 0 0 0\n    list-style-type: none\n    \n  .icon-list li\n    display: flex\n    align-items: center\n    margin: 2px 0\n    padding: 0\n    border: 1px solid #ccc\n    border-radius: 4px\n    height: 30px\n    overflow: hidden\n    \n  .icon-list li .flexrow\n    display: flex\n    align-items: center\n    width: 100%\n    height: 100%\n    \n  .icon-list li .flex0.image\n    flex: 0 0 30px\n    height: 100%\n    display: flex\n    align-items: center\n    justify-content: center\n    margin-right: 4px\n    \n  .icon-list li .flex0.image img.icon\n    width: 30px\n    height: 30px\n    object-fit: cover\n    \n  .icon-list li .flex2\n    display: flex\n    align-items: center\n    padding: 0 8px\n    flex-grow: 1\n    height: 100%\n    font-size: 0.9rem\n    \n  .icon-list li.error-item\n    border-color: #ff6b6b\n    background-color: rgba(255, 107, 107, 0.1)\n    \n  .icon-list li.error-item .flex2\n    color: #ff6b6b\n    font-style: italic\n    font-size: 0.8rem\n</style>"],"names":["ctx"],"mappings":";;;;;;;;;;;;;;;;;;IAkDmW,IAAW,CAAA,EAAC,cAAc;AAAA,EAAI;;iCAAnC,QAAI,KAAA,GAAA;;;;;;;;;;;;QAA5E,IAAK,CAAA;AAAA,MAAA;gBAAC,GAAK;;;;;;;;;;;;AAArF,aAA0H,QAAA,KAAA,MAAA;AAArG,aAA+F,KAAA,EAAA;AAAzE,aAAwB,IAAA,KAAA;AAAA,aAAyB,IAAA,KAAA;;;AAAA,aAAmB,IAAA,KAAA;AAAW,aAAwxB,QAAA,IAAA,MAAA;;;;;;;;;;;;QAAx0BA,KAAK,CAAA;AAAA,MAAA;;;;;UAAwEA,KAAW,CAAA,EAAC,cAAc;AAAA,QAAI;;mCAAnC,QAAI,KAAA,GAAA;;;;;;;;;;;;;wCAAJ;AAAA;;;;;;;;;;;;;;gBAA9M;AAAA;AAAA,IAAoB,IAAW,CAAA;AAAA,IAAE;AAAA,EAAM,IAAA;;;;;;;;;;;AAApF,aAAkG,QAAA,MAAA,MAAA;AAA7E,aAAuE,MAAA,IAAA;;;;;kCAA/C;AAAA;AAAA,QAAoBA,KAAW,CAAA;AAAA,QAAE;AAAA,MAAM,IAAA,IAAA,UAAA,GAAA,OAAA;AAAA;;;;;;;;;;;;;gBAAu2B;AAAA;AAAA,IAAgB,IAAI,CAAA,EAAC;AAAA,EAAI,IAAA;;;;;;;;;;;;;;;;AAA9M,aAAiO,QAAA,IAAA,MAAA;AAArM,aAAgM,IAAA,IAAA;AAA3K,aAAgH,MAAA,IAAA;AAAA,aAAqD,MAAA,IAAA;;;;;kCAAjC;AAAA;AAAA,QAAgBA,KAAI,CAAA,EAAC;AAAA,MAAI,IAAA,IAAA,UAAA,GAAA,OAAA;AAAA;;;;;;;;;;;;;MAAhoBA,KAAI,CAAA;AAAA,KAAA,QAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;gBAA+W;AAAA;AAAA,IAAgB,IAAI,CAAA,EAAC;AAAA,EAAI,IAAA;;;;;;;;;;;;;;;;AAA9M,aAAiO,QAAA,IAAA,MAAA;AAArM,aAAgM,IAAA,IAAA;AAA3K,aAAgH,MAAA,IAAA;AAAA,aAAqD,MAAA,IAAA;;;;;kCAAjC;AAAA;AAAA,QAAgBA,KAAI,CAAA,EAAC;AAAA,MAAI,IAAA,IAAA,UAAA,GAAA,OAAA;AAAA;;;;;;;;;;;;;;;;AAAhP,MAAA;AAAA;AAAA,IAAA,OAAK,OAAI;AAAA;;;;;;;;;;;AAAhE,UAAA,CAAA,cAAA,IAAA,KAAA;AAAA,MAAA,OAAK,GAAG,EAAA,MAAA,KAAA,OAAA,aAAA;AAAS,WAAA,KAAA,OAAA;AAAA,MAAA,OAAK,IAAI;;;;;;;AAA1H,aAAkL,QAAA,IAAA,MAAA;AAAjK,aAA4J,IAAA,IAAA;AAAvI,aAA6F,MAAA,IAAA;AAA3D,aAAqD,MAAA,GAAA;AAAM,aAAoC,MAAA,IAAA;;;;AAAvE,UAAA;AAAA,MAAA,KAAA,CAAA,cAAA,IAAA,KAAA;AAAA,MAAAA,QAAK,GAAG,GAAA;;;AAAS,UAAA;AAAA,MAAA,KAAA,mBAAA;AAAA,MAAAA,QAAK,OAAI;;;AAA6B,UAAA;AAAA,MAAA,KAAA,aAAA;AAAA,MAAAA,QAAK,OAAI,IAAA,UAAA,GAAA,OAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;2BAA1M;AAAA;AAAA,IAAS,IAAI,CAAA,EAAC;AAAA,EAAI,GAAA,IAAA;;;;;;;;;;;;;;;;kCAAlB;AAAA;AAAA,QAAS,IAAI,CAAA,EAAC;AAAA,MAAI,MAAA,eAAA,SAAA,IAAA,EAAA;AAAA;;;;;;;;;;;;;;;;;;;;MAAjWA,KAAW,CAAA,EAAC,UAAU;AAAA,KAAS,QAAA;;;;;;;;;;AAAvD,WAAA,KAAA,aAAA;AAAA,MAAA,OAAY,IAAI;AAAA;;AAA3D,aAAwmC,QAAA,KAAA,MAAA;;;;;;;;;;;;;;AAA7jC,UAAA;AAAA,MAAA,KAAA,yBAAA;AAAA,MAAAA,QAAY,OAAI;;;;;;;;;;;;;;AArChD,SAAA,0BAA0B,MAAI;;AAG7B,UAAA,QAAQ,KAAK,MAAM,GAAG;QACxB,MAAM,UAAU,KAAK,MAAM,CAAC,MAAM,cAAY;AACzC,aAAA,MAAM,CAAC;AAAA;WAET;AAAA,WACA,OAAK;WACL;AAAA;;AAcF,SAAA,gBAAgB,MAAI;QACrB,iBAAiB,0BAA0B,IAAI;MACjD,gBAAc;0BACM,cAAc;AAAA;gCAER,IAAI;;;;AArCzB,MAAA,EAAA,cAAc,KAAI,IAAA;AAwC7B,UAAO,YAAA;AAAA;;;;;;;AAtCN,mBAAA,GAAE,QAAQ,aAAa,eAAe,UAAU,CAAC,IACvC,OAAA,YAAY,cAAc,QAAQ,CAAC,MAAM,YAAY,YAAY,cAAc,QAAQ,CAAC,MAAM,OACnG,YAAY,cAAc,QAAQ,CAAC,EAAE,QACrC,YAAY,cAAc,QAAQ,CAAC,IACrC,GAAG;AAAA;;;;;;;;;;"}