{"version":3,"file":"Abilities-B4FBHP5B.js","sources":["../src/components/organisms/dnd5e/Tabs/Abilities.svelte"],"sourcesContent":["<script>\n  import SvelteSelect from \"svelte-select\";\n  import {\n    extractMapIteratorObjectProperties,\n    getPackFolders,\n    getRules\n  } from \"~/src/helpers/Utility\";\n  import { getContext, onDestroy, onMount, tick } from \"svelte\";\n  import Tabs from \"~/src/components/molecules/Tabs.svelte\";\n  import ManualEntry from \"~/src/components/molecules/dnd5e/AbilityEntry/ManualEntry.svelte\";\n  import PointBuy from \"~/src/components/molecules/dnd5e/AbilityEntry/PointBuy.svelte\";\n  import Roll from \"~/src/components/molecules/dnd5e/AbilityEntry/Roll.svelte\";\n  import StandardArray from \"~/src/components/molecules/dnd5e/AbilityEntry/StandardArray.svelte\";\n  import IconSelect from \"~/src/components/atoms/select/IconSelect.svelte\";\n  import { localize } from \"#runtime/svelte/helper\";\n  import { MODULE_ID } from \"~/src/helpers/constants\";\n  import { abilityGenerationMethod, abilityRolls, readOnlyTabs } from \"~/src/stores/index\";\n\n  const actor = getContext(\"#doc\");\n  const ruleConfig = {\n    journalId: \"0AGfrwZRzSG0vNKb\",\n    pageId: \"yuSwUFIjK31Mr3DI\",\n  };\n\n  $: isDisabled = $readOnlyTabs.includes(\"abilities\");\n\n  const importAdvancements = async () => {\n    // window.GAS.log.d('options',options)\n    for (const option of options) {\n      try {\n        const module = await import(`~/src/components/molecules/dnd5e/AbilityEntry/${option.type}.svelte`);\n        advancementComponents[option.type] = module.default;\n      } catch (error) {\n        log.e(`Failed to load component for ${option.type}:`, error);\n      }\n    }\n  };\n\n  const selectHandler = async (option) => {\n    active = option.value ?? option ?? null;\n    await importAdvancements();\n    tick();\n    $abilityGenerationMethod = active;\n    // window.GAS.log.d('option', option)\n    // window.GAS.log.d('active', active)\n    // window.GAS.log.d('abilityGenerationMethod', $abilityGenerationMethod)\n  };\n  \n\n  let rules = \"\", active, value, placeHolder = 'Ability Generation Method'\n\n  $: actorObject = $actor.toObject();\n  $: advancementComponents = {};\n  $: richHTML = rules?.content || \"\";\n  $: options = [\n    {\n      value: 1,\n      label: \"Manual Entry\",\n      type: \"ManualEntry\",\n      setting: game.settings.get(MODULE_ID, \"allowManualInput\"),\n    },\n    {\n      value: 2,\n      label: \"Point Buy\",\n      type: \"PointBuy\",\n      setting: game.settings.get(MODULE_ID, \"allowPointBuy\"),\n    },\n    {\n      value: 3,\n      label: \"Roll\",\n      type: \"Roll\",\n      setting: game.settings.get(MODULE_ID, \"allowRolling\"),\n    },\n    {\n      value: 4,\n      label: \"Standard Array\",\n      type: \"StandardArray\",\n      setting: game.settings.get(MODULE_ID, \"allowStandardArray\"),\n    },\n  ].filter((obj) => obj.setting);\n\n  $: if (options.length === 1) {\n    // value = options[0];\n    $abilityGenerationMethod = options[0].value;\n  }\n\n  $: abilityModule = $abilityGenerationMethod ? advancementComponents[options.find(option => option.value === $abilityGenerationMethod).type] : null;\n\n  onMount(async () => {\n    rules = await getRules(ruleConfig);\n    await tick();\n    await importAdvancements();\n  });\n\n</script>\n\n<template lang=\"pug\">\n  div.content\n    .flexrow\n      .flex2.pr-sm.col-a\n        h3.left {localize('GAS.Tabs.Abilities.HowCalculated')}\n        +if(\"options.length > 1\")\n          IconSelect.icon-select({options} {active} {placeHolder} handler=\"{selectHandler}\" id=\"ability-generation-method-select\" bind:value=\"{$abilityGenerationMethod}\" disabled=\"{isDisabled}\")\n          +else()\n            ol.properties-list\n              +each(\"options as option\")\n                li {option.label}\n        +if(\"$abilityGenerationMethod\")\n          .relative\n            svelte:component(this=\"{abilityModule}\")\n            +if(\"isDisabled\")\n              .overlay\n      .flex0.border-right.right-border-gradient-mask \n      .flex3.left.pl-md.scroll.col-b {@html richHTML}\n</template>\n\n<style lang=\"sass\" scoped>\n@use \"../../../../../styles/Mixins.scss\" as mixins\n.content \n  +mixins.staticOptions\n\n  .col-a\n    // max-width: 325px\n\n:global(.icon-select)\n  position: relative\n\n.relative\n  position: relative\n\n.overlay\n  position: absolute\n  top: 0\n  left: 0\n  right: 0\n  bottom: 0\n  background-color: rgba(200, 200, 200, 0.3)\n  pointer-events: all\n  cursor: not-allowed\n  z-index: 100\n  transition: background-color 0.2s ease\n  &:hover\n    background-color: rgba(200, 200, 200, 0.4)\n</style>\n"],"names":["ctx"],"mappings":"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"}