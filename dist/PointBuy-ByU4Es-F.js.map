{"version":3,"file":"PointBuy-ByU4Es-F.js","sources":["../src/components/molecules/dnd5e/AbilityEntry/PointBuy.svelte"],"sourcesContent":["<script>\n  import { log } from \"~/src/helpers/Utility\";\n  import { Timing } from \"@typhonjs-fvtt/runtime/util\";\n  import { createEventDispatcher, getContext, setContext, onDestroy, onMount, tick  } from \"svelte\";\n  import { abilities, race, pointBuy, abilityRolls } from \"~/src/helpers/store\"\n  import { POINT_BUY_COSTS, MODULE_ID } from \"~/src/helpers/constants\"\n  import { localize } from \"#runtime/svelte/helper\";\n  \n  export let document = false;\n  \n  const dispatch = createEventDispatcher();\n  const doc = document || getContext(\"#doc\");\n  const updateDebounce = Timing.debounce(updateValue, 100);\n\n  function updateValue(attr, event) {\n    if(event.target.value < 8) return false;\n    if(event.target.value > 15) return false;\n    const options = {system: {abilities: { [attr]: {value: Number(event.target.value)}}}};\n    $doc.updateSource(options)\n    $doc = $doc\n  }\n\n  function reset() {\n    $abilityRolls = {};\n    const options = {system: {abilities: {}}};\n    systemAbilitiesArray.forEach(ability => {\n      options.system.abilities[ability[1].abbreviation] = {value: 10};\n    });\n    $doc.updateSource(options);\n    $doc = $doc;\n  }\n  \n\n  $: systemAbilities = game.system.config.abilities\n  $: systemAbilitiesArray = Object.entries(systemAbilities);\n  $: raceFeatScore = 0;\n  $: abilityAdvancements = $race?.advancement?.byType?.AbilityScoreImprovement?.[0].configuration?.fixed\n  $: scoreTotal = systemAbilitiesArray.reduce((acc, ability) => acc + POINT_BUY_COSTS[Number($doc.system.abilities[ability[1].abbreviation]?.value)], 0)\n  $: pointBuyLimit = game.settings.get(MODULE_ID, \"pointBuyLimit\")\n  $: activeClass = scoreTotal !== pointBuyLimit ? ' active' : '';\n  $: pointBuyClass = scoreTotal > pointBuyLimit ? 'red'+activeClass: 'green'+activeClass\n\n  $: $pointBuy = {scoreTotal, pointBuyLimit}\n\n\n  onMount(async () => {\n  });\n</script>\n\n<template lang=\"pug\">\n.attribute-entry.mt-sm\n  h5.flexrow.mb-sm\n    .flex2.left Ability\n    .flex1.center Race / Feat\n    .flex1.center Base Score\n    .flex1.center Score\n    .flex1.center Modifier\n  .indent\n    +each(\"systemAbilitiesArray as ability, index\")\n      .flexrow.mb-sm\n        .flex2.left {ability[1].label}\n        .flex1.center.align-text-with-input\n          +if(\"abilityAdvancements?.[ability[1].abbreviation] > 0\")\n            span +\n          span {abilityAdvancements?.[ability[1].abbreviation] || 0}\n        .flex1.center.relative\n          input.left.small.mainscore(disabled type=\"number\" value=\"{$doc.system.abilities[ability[1].abbreviation]?.value}\" name=\"{ability[1].abbreviation}\" id=\"{ability[1].abbreviation}\" )\n          .controls\n            .up.chevron\n              i.fas.fa-chevron-up(alt=\"Decrease\" on:click!=\"{updateDebounce(ability[1].abbreviation, {target: {value: Number($doc.system.abilities[ability[1].abbreviation]?.value) + 1}})}\")\n            .down.chevron\n              i.fas.fa-chevron-down(alt=\"Increase\" on:click!=\"{updateDebounce(ability[1].abbreviation, {target: {value: Number($doc.system.abilities[ability[1].abbreviation]?.value) - 1}})}\")\n        .flex1.center.align-text-with-input {(Number(abilityAdvancements?.[ability[1].abbreviation]) || 0) + Number($doc.system.abilities[ability[1].abbreviation]?.value || 0)}\n        .flex1.center.align-text-with-input \n          +if(\"$doc.system.abilities[ability[1].abbreviation]?.mod > 0\")\n            span +\n          span {$doc.system.abilities[ability[1].abbreviation]?.mod}\n    hr\n    .flexrow.justify-flexrow-vertical\n      .flex1 Points total: \n      .flex\n        +if(\"isNaN(scoreTotal)\")\n          span.red(data-tooltip=\"{localize('GAS.Setting.AbilityEntry.AllowPointBuy.InvalidTotal')}\") N/A\n          +else()\n            input.score.center.small( disabled class=\"{pointBuyClass}\"  type=\"number\" value=\"{scoreTotal}\") \n      .flex0 / \n      .flex1 \n        input.center.small(disabled  type=\"number\" value=\"{pointBuyLimit}\") \n    \n    +if(\"isNaN(scoreTotal)\")\n      hr\n      button.btn.btn-primary(on:click=\"{reset}\") Reset scores\n\n</template>\n\n<style lang=\"sass\">\n  .align-text-with-input\n    margin-top: 0.3rem\n  .green\n    color: green\n  .red\n    color: red\n  .mainscore\n    min-width: 40px\n  .score\n\n    &.active\n      animation: pulse 0.5s infinite\n  .controls\n    .chevron\n      position: absolute\n      font-size: 0.75rem\n      right: 0\n      cursor: pointer\n      background-color: rgba(0, 0, 0, 0.1)\n      &.up\n        padding: 1px 3px 0px 3px\n        top: 0\n        &:hover\n          background-color: rgba(140, 90, 0, 0.2)\n      &.down\n        padding: 1px 3px 0px 3px\n        bottom: 0\n        &:hover\n          background-color: rgba(140, 90, 0, 0.2)\n    \n</style>"],"names":["ctx","attr"],"mappings":"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"}