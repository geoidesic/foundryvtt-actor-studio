{"version":3,"file":"IconSelect-p6s3hvAL.js","sources":["../src/components/atoms/select/IconSelect.svelte"],"sourcesContent":["<script>\n\n  /**\n   * @author: Noel da Costa\n   * @copyright: Arc Digital Limited 11-05-2024\n   * @license: https://creativecommons.org/licenses/by/4.0/\n   */\n\n    import { onMount, onDestroy } from \"svelte\";\n    import { truncate } from \"~/src/helpers/Utility.js\";\n    import { MODULE_ID } from \"~/src/helpers/constants\";\n\n    export let options = []; //- {value, label, icon || img}\n    export let value = \"\"; //- the currently selected uuid\n    export let disabled = false;\n    export let handler = void 0;\n    export let shrinkIfNoIcon = true;\n    export let placeHolder = false;\n    export let id = void 0;\n    export let noImg = false;\n    export let truncateWidth = 20;\n\n    let isOpen = false;\n    export let handleSelect = (option) => {\n      if (handler) {\n        if (handler(option.value)) {\n          value = option.value;\n        }\n      } else {\n        console.warn('You need to pass a click handler in')\n      }\n      toggleDropdown();\n    };\n\n    const showPackLabelInSelect = game.settings.get(MODULE_ID, 'showPackLabelInSelect');\n\n    function getLabel(option) {\n      if (showPackLabelInSelect && option.packLabel) {\n        return `[${option.packLabel}] ${option.label}`;\n      }\n      return option.label;\n    }\n\n    function toggleDropdown() {\n      if (disabled) {\n        isOpen = false;\n        return;\n      }\n      isOpen = !isOpen;\n    }\n\n    function handleKeydown(event) {\n      if (event.key === 'Enter' || event.key === ' ') {\n        event.preventDefault();\n        if (event.currentTarget.getAttribute('role') === 'option') {\n          this.handleSelect(event.currentTarget.option);\n        } else {\n          this.toggleDropdown();\n        }\n      }\n    }\n\n    function isClickOutsideContainer(event, containerElement) {\n      try {\n        const targetElement = event.target;\n\n        // Check if the target element is the container itself\n        if (targetElement === containerElement) {\n          return false;\n        }\n\n        // Guard: if containerElement is null, treat as click outside\n        if (!containerElement) {\n          console.warn('[IconSelect] containerElement is null, treating as click outside');\n          return true;\n        }\n\n        // Guard: if targetElement is null, treat as click outside\n        if (!targetElement) {\n          console.warn('[IconSelect] targetElement is null, treating as click outside');\n          return true;\n        }\n\n        // Check if the target element is inside the container\n        return !containerElement.contains(targetElement);\n      } catch (error) {\n        console.error('[IconSelect] Error in isClickOutsideContainer:', error);\n        return true; // Treat as click outside on error\n      }\n    }\n\n    function handleClickOutside(event) {\n      try {\n        const containerElement = document.getElementById(id);\n        if (!containerElement) {\n          console.warn('[IconSelect] Element with id', id, 'not found, treating as click outside');\n          // Element not found, treat as click outside and close\n          isOpen = false;\n          return;\n        }\n        const isClickOutside = isClickOutsideContainer(event, containerElement);\n        if(isClickOutside) {\n          isOpen = false;\n        }\n      } catch (error) {\n        console.error('[IconSelect] Error in handleClickOutside:', error);\n        isOpen = false; // Close on error\n      }\n    }\n\n    onMount(() => {\n      window.addEventListener(\"click\", handleClickOutside);\n    });\n    onDestroy(() => {\n      window.removeEventListener(\"click\", handleClickOutside);\n    });\n\n    let textOnly = (option) => {\n      return option.icon || option.img ? false : true;\n    }\n\n    \n  </script>\n\n<template lang=\"pug\">\ndiv.custom-select({...$$restProps} {id} role=\"combobox\" aria-expanded=\"{isOpen}\" aria-haspopup=\"listbox\" aria-controls=\"options-list\" tabindex=\"0\")\n  div.selected-option(on:click=\"{toggleDropdown}\" on:keydown=\"{handleKeydown}\" role=\"button\" aria-expanded=\"{isOpen}\" aria-haspopup=\"listbox\" tabindex=\"0\" class:selected=\"{isOpen}\" class:disabled=\"{disabled}\")\n    +if(\"placeHolder && !value\")\n      div.placeholder {placeHolder}\n    +each(\"options as option, index\")\n      +if(\"option && option?.value === value\")\n        +if(\"!noImg && !textOnly(option) && shrinkIfNoIcon\")\n          div.option-icon(class=\"{option.img ? option.img : ''}\")\n            +if(\"option.icon != undefined\")\n              i(class=\"{option.icon}\")\n              +else\n                img(src=\"{option.img}\" alt=\"{option.label}\")\n        div.option-label {truncate(option.label, truncateWidth)}\n    div.chevron-icon\n      i(class=\"fas fa-chevron-down\")\n\n  +if(\"isOpen\")\n    div.options-dropdown.dropshadow(id=\"options-list\" role=\"listbox\")\n      +each(\"options as option, index\")\n        +if(\"option && option?.value !== value\")\n          div.option(role=\"option\"  on:click=\"{handleSelect(option)}\" on:keydown=\"{handleKeydown}\" tabindex=\"0\")\n            +if(\"!textOnly(option) && shrinkIfNoIcon\")\n              div.option-icon(class=\"{option.img ? option.img : ''}\")\n                +if(\"option.icon != undefined\")\n                  i(class=\"{option.icon}\")\n                  +else\n                    img(src=\"{option.img}\" alt=\"{option.label}\")\n            div.option-label {getLabel(option)}\n</template>\n\n<style lang=\"sass\">\n.custom-select\n  position: relative\n  display: inline-block\n  min-height: var(--tjs-select-height, 32px)\n\n.selected-option\n  display: flex\n  align-items: left\n  padding: 0.35rem 1.75rem 0.35rem 0.15rem\n  font-size: 0.875rem\n  font-weight: 400\n  color: #212529\n  background-color: #fff\n  border: 1px solid #ced4da\n  border-radius: 0.25rem\n  cursor: pointer\n  white-space: nowrap\n  overflow: hidden\n  text-overflow: ellipsis\n  position: relative\n\nimg\n  position: absolute\n  top: -3px\n  left: 0\n  width: 24px\n  height: 24px\n  vertical-align: middle\n\n.selected-option\n  &.disabled\n    cursor: not-allowed\n    opacity: 0.6\n    .chevron-icon\n      i\n        color: var(--color-text-disabled)\n        \n  &:selected\n    display: none\n    border-color: #80bdff\n  \n        \n.option-icon\n  position: relative\n  min-width: 24px\n  margin-right: 8px\n\n.option-label\n  flex-grow: 1\n  text-align: left\n\n.chevron-icon\n  position: absolute\n  right: 0.5rem\n\n.options-dropdown\n  position: absolute\n  top: calc(100% + 4px)\n  left: 0\n  width: 100%\n  background-color: #fff\n  border: 1px solid #ced4da\n  border-radius: 0.25rem\n  overflow: hidden\n  z-index: 999\n\n.option\n  display: flex\n  align-items: left\n  padding: 4px\n  font-size: 0.875rem\n  font-weight: 400\n  line-height: 1.5\n  color: #212529\n  cursor: pointer\n\n\n  &:hover\n    background-color: var(--select-option-highlight-color)\n</style>\n"],"names":["ctx"],"mappings":"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"}